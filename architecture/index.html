<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.69">
<title data-react-helmet="true">Pallets | Opensquare Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_language" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Pallets | Opensquare Docs"><meta data-react-helmet="true" name="description" content="Basic bounty workflow"><meta data-react-helmet="true" property="og:description" content="Basic bounty workflow"><meta data-react-helmet="true" property="og:url" content="https://docs.opensquare.network/architecture"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.opensquare.network/architecture"><link rel="stylesheet" href="/styles.dd2612b2.css">
<link rel="preload" href="/styles.a8c35019.js" as="script">
<link rel="preload" href="/runtime~main.77f4362e.js" as="script">
<link rel="preload" href="/main.e747c401.js" as="script">
<link rel="preload" href="/common.763986e0.js" as="script">
<link rel="preload" href="/2.54686c0e.js" as="script">
<link rel="preload" href="/11.98ead4c8.js" as="script">
<link rel="preload" href="/935f2afb.6b41e80c.js" as="script">
<link rel="preload" href="/17896441.5689e6cc.js" as="script">
<link rel="preload" href="/461f2428.0ca06057.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_2AhQ">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Opensquare Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo.svg" alt="Opensquare Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/opensquare-network" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Opensquare Logo" class="themedImage_2E_h themedImage--light_AouX navbar__logo"><img src="/img/logo.svg" alt="Opensquare Logo" class="themedImage_2E_h themedImage--dark_1YPN navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/opensquare-network" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive thin-scrollbar menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Welcome</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/getting-started/preparation">Preparation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/getting-started/bounty-flow">Bounty Flow</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Architecture</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/architecture">Pallets</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_39qw"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Pallets</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="basic-bounty-workflow"></a>Basic bounty workflow<a class="hash-link" href="#basic-bounty-workflow" title="Direct link to heading">#</a></h2><p>Currently we implement a basic workflow which support OneFunderOneHunter bounty collaboration. You can check the details in the bounty workflow section. But you can check following content for a general view.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="roles"></a>Roles:<a class="hash-link" href="#roles" title="Direct link to heading">#</a></h3><ul><li>Funder: who create and fund bounty.</li><li>Hunter: who hunt bounty and work for the assigned bounty.</li><li>Council: who review funders&#x27; bounty application and give feedback(yes or no). </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="a-example-workflow"></a>A example workflow<a class="hash-link" href="#a-example-workflow" title="Direct link to heading">#</a></h3><ol><li>Alice(funder) create a bounty with 1000 native token funded, and waiting for the council to review.</li><li>The council review the bounty and give the review result(Yes or No).</li><li>Bob(hunter) can see the bounty and do hunting for the bounty.</li><li>Alice see the hunting for the bounty and assign the bounty to Bob.</li><li>Bob finish the work and do a submission for the bounty.</li><li>Alice resolve the bounty and give Bob &#x27;Perfect&#x27; remark. Several things will happen:<ul><li>Then 900 will be sent to Bob, while 100 will be sent to the council. </li><li>Bob will get 2 times reputation added, one for resolving the bounty and another for the remark. </li><li>Alice and Bob will get mining power. The total power will be decided by the fee the council got, and 90% of the power will be assigned to funder and 10% to hunter.</li></ul></li><li>Bob give a &#x27;Perfect&#x27; remark to Alice, and then Alice will get a reputation grow.</li></ol><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pallets"></a>Pallets<a class="hash-link" href="#pallets" title="Direct link to heading">#</a></h2><p>We build our business based on <a href="https://github.com/paritytech/substrate" target="_blank" rel="noopener noreferrer">Substrate</a>. There are mainly 3 pallets involved to support the business.</p><ul><li><a href="https://github.com/opensquare-network/opensquare/tree/w3f-m1-0/ospallet/bounties" target="_blank" rel="noopener noreferrer">bounties</a> pallet manages the lifecycle of a bounty.</li><li><a href="https://github.com/opensquare-network/opensquare/tree/w3f-m1-0/ospallet/reputation" target="_blank" rel="noopener noreferrer">reputation</a> pallet manages each role&#x27;s reputation.</li><li><a href="https://github.com/opensquare-network/opensquare/tree/w3f-m1-0/ospallet/mining" target="_blank" rel="noopener noreferrer">mining</a> pallet manages users&#x27; session related mining power and handle the native token mint logic.</li></ul><p>Functions in reputation and mining pallets will be called by some calls in bounties pallet. For example: </p><ul><li>When <a href="https://github.com/opensquare-network/opensquare/blob/w3f-m1-0/ospallet/bounties/src/lib.rs#L201" target="_blank" rel="noopener noreferrer">resolve_bounty_and_remark</a> is called, <a href="https://github.com/opensquare-network/opensquare/blob/w3f-m1-0/ospallet/reputation/src/lib.rs#L49" target="_blank" rel="noopener noreferrer">add_behavior_score_by_behavior</a>,
<a href="https://github.com/opensquare-network/opensquare/blob/w3f-m1-0/ospallet/mining/src/lib.rs#L113" target="_blank" rel="noopener noreferrer">add_mining_power</a> will be called to add reputation nd mining power to hunter.</li><li>When <a href="https://github.com/opensquare-network/opensquare/blob/w3f-m1-0/ospallet/bounties/src/lib.rs#L248" target="_blank" rel="noopener noreferrer">remark_bounty_funder</a> is called, <a href="https://github.com/opensquare-network/opensquare/blob/w3f-m1-0/ospallet/reputation/src/lib.rs#L49" target="_blank" rel="noopener noreferrer">add_behavior_score_by_behavior</a> is called to add funder&#x27;s reputation.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="bounties-pallet"></a>bounties pallet<a class="hash-link" href="#bounties-pallet" title="Direct link to heading">#</a></h3><p>The bounties module provide management for bounties. Generally speaking, it facilitate the collaborations between
funders, hunters and the council.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="funder-calls"></a>Funder calls<a class="hash-link" href="#funder-calls" title="Direct link to heading">#</a></h4><ul><li><code>create_bounty</code>: Create a bounty and deposit the fund, and this bounty will be reviewed by the council.</li><li><code>assign_bounty</code>: Assign the bounty to one applicant.</li><li><code>close_bounty</code>: Close the bounty.</li><li><code>resolve_bounty_and_remark</code>: Resolve the bounty and the fund will be sent to the assigned hunter, while some fee will be charged by the council.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="hunter-calls"></a>Hunter calls<a class="hash-link" href="#hunter-calls" title="Direct link to heading">#</a></h4><ul><li><code>hunt_bounty</code>: Apply a accepted bounty.</li><li><code>submit_bounty</code>: Submit the work result for the assigned bounty.</li><li><code>cancel_bounty</code>: Cancel the application for the bounty.</li><li><code>resign_from_bounty</code>: Resign from a assigned bounty.</li><li><code>remark_bounty_funder</code>: Remark the bounty funder after the funder resolve the bounty and give the remark to hunter.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="council-calls"></a>Council calls<a class="hash-link" href="#council-calls" title="Direct link to heading">#</a></h4><ul><li><code>examine_bounty</code>: Give the review result for a bounty.</li><li><code>force_close_bounty</code>: Force close a bounty. The reasons may include outdated description, longtime no applicants.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="reputation-pallet"></a>reputation pallet<a class="hash-link" href="#reputation-pallet" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="terminology"></a>Terminology<a class="hash-link" href="#terminology" title="Direct link to heading">#</a></h4><ul><li>CollaborationUnit: A interaction of between roles of OpenSquare.</li><li>CollaborationResult: The result of a collaboration, usually the result will be with a enum type.</li><li>Behavior: It&#x27;a union of all collaboration results.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="current-behaviors-defined"></a>Current Behaviors defined<a class="hash-link" href="#current-behaviors-defined" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-rust codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[cfg_attr(feature = &quot;std&quot;, derive(Serialize, Deserialize))]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub enum BountyResolveCollaborationResult {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Success,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Fail,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[derive(PartialEq, Eq, Clone, Encode, Decode, RuntimeDebug)]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[cfg_attr(feature = &quot;std&quot;, derive(Serialize, Deserialize))]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub enum BountyRemarkCollaborationResult {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Bad,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NotGood,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Fine,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Good,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Perfect,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">// Behavior represent the general collaboration result</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#[cfg_attr(feature = &quot;std&quot;, derive(Serialize, Deserialize), serde(untagged))]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">pub enum Behavior {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BountyResolve(BountyResolveCollaborationResult),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    BountyRemark(BountyRemarkCollaborationResult),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="reputation-score"></a>Reputation Score<a class="hash-link" href="#reputation-score" title="Direct link to heading">#</a></h4><p>Each Behavior(CollaborationResult) has a corresponding reputation score.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="interfaces"></a>Interfaces<a class="hash-link" href="#interfaces" title="Direct link to heading">#</a></h4><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><div tabindex="0" class="prism-code language-rust codeBlock_3iAC thin-scrollbar"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">fn add_behavior_score_by_behavior(target: &amp;AccountId, behavior: &amp;Behavior);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button></div></div><p>This interface will be called in collaboration modules(bounties). The <code>behavior</code> param will be different based on the caller module&#x27;s business.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mining-pallet"></a>mining pallet<a class="hash-link" href="#mining-pallet" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="terminology-1"></a>Terminology<a class="hash-link" href="#terminology-1" title="Direct link to heading">#</a></h4><ul><li>Session: Each session contains a fixed number of blocks(currently 43200).</li><li>SessionIndex: It begins with 0 and grows 1 after each 43200 blocks.</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="mining-logic"></a>Mining logic<a class="hash-link" href="#mining-logic" title="Direct link to heading">#</a></h4><p>One session is a mining period, while the max of the total mint token will be 1% of the total issuance. The mint token
can be claimed after the session, and each miners&#x27; mining power will decide how much token they can claim.</p><p>For example, total issuance is 10,000, and total mining power is 100, while Alice&#x27;s mining power is 10. So Alice can mine
10 / 100 <em> 10000 </em> 0.01 = 10 in this session.</p><p>The mining power is decided by the fee the council charged. For example, the bounty fund total 1000 OSN and 50 will be charged by the council.
The total mining power for this bounty will be 50 * OSN_currency_ration. Each currency has a currency ratio, and currency ratio of OSN is 1.
So 50 will be the total mining power for the bounty. Funder and hunter will get 90% and 10% of the mining power, so funder get 45 and hunter get 5.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="interfaces-1"></a>Interfaces<a class="hash-link" href="#interfaces-1" title="Direct link to heading">#</a></h4><ul><li><code>claim(session_index: SessionIndex)</code>: Claim the native token based on the caller&#x27;s mining power for the target session.</li><li><code>add_mining_power(target: &amp;T::AccountId, power: MiningPower)</code>: Called by other modules to add mining power for one target account.</li><li><code>add_session_total_mining_power(power: MiningPower)</code>: Called by other modules to add the session total mining power.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/opensquare-network/docs/tree/master/website/docs/pallets.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/getting-started/bounty-flow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Bounty Flow</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basic-bounty-workflow" class="table-of-contents__link">Basic bounty workflow</a><ul><li><a href="#roles" class="table-of-contents__link">Roles:</a></li><li><a href="#a-example-workflow" class="table-of-contents__link">A example workflow</a></li></ul></li><li><a href="#pallets" class="table-of-contents__link">Pallets</a><ul><li><a href="#bounties-pallet" class="table-of-contents__link">bounties pallet</a></li><li><a href="#reputation-pallet" class="table-of-contents__link">reputation pallet</a></li><li><a href="#mining-pallet" class="table-of-contents__link">mining pallet</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright Â© 2020 Opensquare, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.a8c35019.js"></script>
<script src="/runtime~main.77f4362e.js"></script>
<script src="/main.e747c401.js"></script>
<script src="/common.763986e0.js"></script>
<script src="/2.54686c0e.js"></script>
<script src="/11.98ead4c8.js"></script>
<script src="/935f2afb.6b41e80c.js"></script>
<script src="/17896441.5689e6cc.js"></script>
<script src="/461f2428.0ca06057.js"></script>
</body>
</html>